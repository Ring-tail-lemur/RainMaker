{"version":3,"file":"checkNetworkConnection.js","sourceRoot":"","sources":["../../../src/util/checkNetworkConnection.ts"],"names":[],"mappings":"AAAA,uCAAuC;AACvC,kCAAkC;AAElC,OAAO,EAAE,WAAW,EAAE,OAAO,EAAE,OAAO,IAAI,UAAU,EAAE,MAAM,KAAK,CAAC;AAClE,OAAO,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AAEhC;;;GAGG;AACH,MAAM,UAAU,sBAAsB,CAAC,IAAY;IACjD,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE;QAC7B,MAAM,CAAC,OAAO,CAAC,6DAA6D,CAAC,CAAC;QAC9E,UAAU,CAAC,IAAI,EAAE,UAAU,GAAQ;YACjC,IAAI,GAAG,EAAE;gBACP,MAAM,CAAC,OAAO,CACZ,qEAAqE,EACrE,GAAG,CAAC,IAAI,IAAI,GAAG,CAAC,IAAI,EACpB,GAAG,CACJ,CAAC;gBACF,2GAA2G;gBAC3G,8GAA8G;gBAC9G,IAAI,GAAG,CAAC,IAAI,KAAK,WAAW,IAAI,GAAG,CAAC,IAAI,KAAK,OAAO,EAAE;oBACpD,OAAO,OAAO,CAAC,KAAK,CAAC,CAAC;iBACvB;aACF;iBAAM;gBACL,MAAM,CAAC,OAAO,CAAC,yEAAyE,CAAC,CAAC;aAC3F;YAED,OAAO,OAAO,CAAC,IAAI,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { CONNREFUSED, TIMEOUT, resolve as dnsResolve } from \"dns\";\nimport { logger } from \"../log\";\n\n/**\n * Checks whether a network connection is detected.\n * @internal\n */\nexport function checkNetworkConnection(host: string): Promise<boolean> {\n  return new Promise((resolve) => {\n    logger.verbose(\"Calling dns.resolve to determine network connection status.\");\n    dnsResolve(host, function (err: any): void {\n      if (err) {\n        logger.verbose(\n          \"Error thrown from dns.resolve in network connection check: '%s', %O\",\n          err.code || err.name,\n          err\n        );\n        // List of possible DNS error codes: https://nodejs.org/dist/latest-v12.x/docs/api/dns.html#dns_error_codes\n        // We only resolve with `false` when dnsResolve fails with an error we expect to see when the network is down.\n        if (err.code === CONNREFUSED || err.code === TIMEOUT) {\n          return resolve(false);\n        }\n      } else {\n        logger.verbose(\"Successfully resolved host via dns.resolve in network connection check.\");\n      }\n\n      return resolve(true);\n    });\n  });\n}\n"]}